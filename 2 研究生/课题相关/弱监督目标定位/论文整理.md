# 弱监督目标定位论文整理





## 1.Unveiling the Potential of Structure Preserving for Weakly Supervised Object Localization

## 简介

这篇是CVPR2021的文章，这篇文章提出的方法主要运用了热力图的空间相关性，利用feature map的自相关性以及热力图获得的目标最具判别力的区域得到目标整体。

## 主要方法

作者将其命名为Structure-Preserving Activation，主要包括两个模块，分别是Restricted Activation Module和Self-correlation Map，前一个模块直接使用热力图中的信息通过阈值限制生成背景无物体部分，后一个模块利用热力图的自相关性学习空间相关性的信息再次得到背景和目标部分。

### Restricted Activation Module

![image-20210406215024366](image-20210406215024366.png)

在获得热力图CAM之后通过阈值选取得到背景$M_{bg}$和目标区域$M_{obj}$

![image-20210406215106836](image-20210406215106836.png)

![image-20210406215116231](image-20210406215116231.png)

然后和原始的CAM图做像素级别的loss：

![image-20210406215337542](image-20210406215337542.png)

这部分能够使得热力图更多的关注于目标部分。

### Self-correlation Map Generating

![image-20210406215437935](image-20210406215437935.png)

这部分使用CAM的自相关图学习与目标区域以及背景区域在空间上相似的部分。

- 生成自相关图

一阶自相关：首先需要生成自相关图，自相关图是衡量feature map像素级别的相似度，其中$f\in R^{HW\times C}$就是生成的feature map，然后单位化后与其转置相再经过ReLU激活后得到的相关性$SC(f)\in R^{HW\times HW}$，这里得到的就是每一个像素和其他像素的相似程度：

![image-20210406215710056](image-20210406215710056.png)

二阶自相关：二阶是在一阶像素相乘计算基础上再次相乘得到的，实际上衡量的是一阶自相关图的自相关性

![image-20210406220317794](image-20210406220317794.png)

在一阶和二阶自相关之后将两者结合就得到高阶自相关图（high-order self-correlation (HSC) ）

![image-20210406221136205](image-20210406221136205.png)

- 得到关注区域，生成特定相关图

通过CAM得到关注区域后就可以将之结合自相关图得到与关注部分像素级别相关的区域，结合之前得到的自相关图以及像素区域得到在HSC下的目标区域：

![image-20210406221145460](image-20210406221145460.png)

由于该目标区域的像素值不是唯一的，所以这个时候对所有该区域像素的相关图取平均值得到物体部分的mask：

![image-20210406221435564](image-20210406221435564.png)

同样的道理也可以获得背景区域的自相关图以及对应的mask，然后通过作差得到最终的关注部分：

![image-20210406221614414](image-20210406221614414.png)

## 主要创新

利用阈值探索背景以及目标区域的手段在SPG中已经有所体现，该论文的主要创新之处在于结合CAM使用的自相关图获取到空间像素级别的相关信息。

## 想法

- 这种像素级别相关性的获取是在最后一层feature map上面，能否在结合原图的像素相关性
- 像素级别的空间相关性显然对于具有同一颜色或者纹理的物体十分适用，但当物体的部分具有明显的不连续区域以及较大差别的时候这种方法适用效果可能较差，如何获取这部分物体的相关特征呢？
- 这里只是使用了一张图片中自身的feature map自相关性，能否结合同类图片的进行相关性分析

- [ ] 论文方法复现